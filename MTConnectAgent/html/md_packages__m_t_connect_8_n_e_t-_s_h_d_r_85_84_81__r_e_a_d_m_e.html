<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Projet MtConnnect: MTConnect.NET-SHDR</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Projet MtConnnect
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Recherche');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MTConnect.NET-SHDR </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Classes to handle the SHDR Agent Adapter Protocol associated with the MTConnect Standard.</p>
<h2>Overview</h2>
<p>The ShdrAdapter classes handle the TCP connection to the Agent:</p>
<ul>
<li><a href="https://github.com/TrakHound/MTConnect.NET/blob/master/src/MTConnect.NET-SHDR/Adapters/Shdr/ShdrAdapter.cs">ShdrAdapter</a> : Sends the most recent values On-Demand using the SendChanged() method. This is used when full control of the communication is needed.</li>
<li><a href="https://github.com/TrakHound/MTConnect.NET/blob/master/src/MTConnect.NET-SHDR/Adapters/Shdr/ShdrIntervalAdapter.cs">ShdrIntervalAdapter</a> : Sends the most recent values at the specified Interval. This is used when a set interval is adequate and the most recent value is all that is needed</li>
<li><a href="https://github.com/TrakHound/MTConnect.NET/blob/master/src/MTConnect.NET-SHDR/Adapters/Shdr/ShdrQueueAdapter.cs">ShdrQueueAdapter</a> : Queues all values that are sent from the PLC and sends them all on demand using the SendBuffer() method. This is used when all values are needed and full control of the communication is needed.</li>
<li><a href="https://github.com/TrakHound/MTConnect.NET/blob/master/src/MTConnect.NET-SHDR/Adapters/Shdr/ShdrIntervalQueueAdapter.cs">ShdrIntervalQueueAdapter</a> : Queues all values that are sent from the PLC and sends any queued values at the specified Interval. This is used when all values are needed but an interval is adequate.</li>
</ul>
<p>SHDR conversion is handled in each individual class:</p><ul>
<li><a href="Shdr/ShdrDataItem.cs">ShdrDataItem</a> : Handles converting Events and/or Samples with a Representation of VALUE to the appropriate SHDR format.</li>
<li><a href="Shdr/ShdrCondition.cs">ShdrCondition</a> : Handles converting Conditions to the appropriate SHDR format</li>
<li><a href="Shdr/ShdrTimeSeries.cs">ShdrTimeSeries</a> : Handles converting Samples with a Representation of TIME_SERIES to the appropriate SHDR format</li>
<li><a href="Shdr/ShdrDataSet.cs">ShdrDataSet</a> : Handles converting Events and/or Samples with a Representation of DATA_SET to the appropriate SHDR format</li>
<li><a href="Shdr/ShdrTable.cs">ShdrTable</a> : Handles converting Events and/or Samples with a Representation of TABLE to the appropriate SHDR format</li>
<li><a href="Shdr/ShdrAsset.cs">ShdrAsset</a> : Handles converting Assets to the appropriate SHDR format</li>
</ul>
<p>The <a href="Adapters/Shdr/ShdrAdapterClient.cs">ShdrAdapterClient</a> class handles the TCP connection to read from the Adapter and add data to an IMTConnectAgent class.</p>
<h2>Usage</h2>
<p>There are several different ways to setup and add data to the ShdrAdapter</p>
<h3>ShdrAdapter</h3>
<p>The example below creates a new ShdrAdapter. The added DataItem will be sent using the "adapter.SendChanged()" method </p><div class="fragment"><div class="line">{c#}</div><div class="line">using MTConnect.Adapters.Shdr;</div><div class="line"></div><div class="line">ShdrAdapter adapter = new ShdrAdapter();</div><div class="line">adapter.Start();</div><div class="line"></div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;);</div><div class="line">adapter.SendChanged();</div></div><!-- fragment --><p> #### SHDR Output </p><div class="fragment"><div class="line">2023-01-26T16:48:17.0206852Z|L2estop|ARMED</div></div><!-- fragment --><h3>ShdrAdapter (specific Port)</h3>
<p>The example below creates a new ShdrAdapter on the 7980 TCP Port. </p><div class="fragment"><div class="line">{c#}</div><div class="line">using MTConnect.Adapters.Shdr;</div><div class="line"></div><div class="line">ShdrAdapter adapter = new ShdrAdapter(7980);</div></div><!-- fragment --><h3>ShdrAdapter (specific Device)</h3>
<p>The example below creates a new ShdrAdapter for the "OKUMA-Lathe" device. The added DataItem will be sent using the "adapter.SendChanged()" method </p><div class="fragment"><div class="line">{c#}</div><div class="line">using MTConnect.Adapters.Shdr;</div><div class="line"></div><div class="line">ShdrAdapter adapter = new ShdrAdapter(&quot;OKUMA-Lathe&quot;, 7980);</div><div class="line">adapter.Start();</div><div class="line"></div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;);</div><div class="line">adapter.SendChanged();</div></div><!-- fragment --><p> #### SHDR Output </p><div class="fragment"><div class="line">2023-01-26T20:54:34.1694626Z|OKUMA-Lathe:L2estop|ARMED</div></div><!-- fragment --><h3>ShdrAdapter (specific Device and Port)</h3>
<p>The example below creates a new ShdrAdapter for the "OKUMA-Lathe" device on the 7980 TCP Port. </p><div class="fragment"><div class="line">{c#}</div><div class="line">using MTConnect.Adapters.Shdr;</div><div class="line"></div><div class="line">ShdrAdapter adapter = new ShdrAdapter(&quot;OKUMA-Lathe&quot;, 7980);</div></div><!-- fragment --><h3>ShdrIntervalAdapter</h3>
<p>The example below creates a new ShdrIntervalAdapter and sets the Interval to 500ms. Only the most recent DataItem with the ID = "L2estop" will be sent after 500ms has elapsed. </p><div class="fragment"><div class="line">{c#}</div><div class="line">using MTConnect.Adapters.Shdr;</div><div class="line"></div><div class="line">ShdrIntervalAdapter adapter = new ShdrIntervalAdapter(interval: 500);</div><div class="line">adapter.Start();</div><div class="line"></div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;);</div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;TRIGGERED&quot;);</div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;);</div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;TRIGGERED&quot;);</div></div><!-- fragment --><p> #### SHDR Output </p><div class="fragment"><div class="line">2023-01-26T17:22:10.3128693Z|L2estop|TRIGGERED</div></div><!-- fragment --><h3>ShdrQueueAdapter</h3>
<p>The example below creates a new ShdrQueueAdapter. All of the added DataItems will be sent using the "adapter.SendBuffer()" method </p><div class="fragment"><div class="line">{c#}</div><div class="line">using MTConnect.Adapters.Shdr;</div><div class="line"></div><div class="line">ShdrQueueAdapter adapter = new ShdrQueueAdapter();</div><div class="line">adapter.Start();</div><div class="line"></div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;);</div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;TRIGGERED&quot;);</div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;);</div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;TRIGGERED&quot;);</div><div class="line">adapter.SendBuffer();</div></div><!-- fragment --><p> #### SHDR Output </p><div class="fragment"><div class="line">2023-01-26T17:22:10.2882160Z|L2estop|ARMED</div><div class="line">2023-01-26T17:22:10.3125127Z|L2estop|TRIGGERED</div><div class="line">2023-01-26T17:22:10.3128389Z|L2estop|ARMED</div><div class="line">2023-01-26T17:22:10.3128693Z|L2estop|TRIGGERED</div></div><!-- fragment --><h3>ShdrIntervalQueueAdapter</h3>
<p>The example below creates a new ShdrIntervalQueueAdapter and sets the Interval to 500ms. All of the added DataItems will be sent after 500ms has elapsed. </p><div class="fragment"><div class="line">{c#}</div><div class="line">using MTConnect.Adapters.Shdr;</div><div class="line"></div><div class="line">ShdrIntervalQueueAdapter adapter = new ShdrIntervalQueueAdapter(interval: 500);</div><div class="line">adapter.Start();</div><div class="line"></div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;);</div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;TRIGGERED&quot;);</div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;);</div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;TRIGGERED&quot;);</div></div><!-- fragment --><p> #### SHDR Output </p><div class="fragment"><div class="line">2023-01-26T17:22:10.2882160Z|L2estop|ARMED</div><div class="line">2023-01-26T17:22:10.3125127Z|L2estop|TRIGGERED</div><div class="line">2023-01-26T17:22:10.3128389Z|L2estop|ARMED</div><div class="line">2023-01-26T17:22:10.3128693Z|L2estop|TRIGGERED</div></div><!-- fragment --><h2>Configuration</h2>
<ul>
<li><code>Id</code> - Get a unique identifier for the Adapter</li>
<li><code>DeviceKey</code> - The Name or UUID of the Device to create a connection for</li>
<li><code>Port</code> - The TCP Port used for communication</li>
<li><code>Heartbeat</code> - The heartbeat used to maintain a connection between the Adapter and the Agent</li>
<li><code>ConnectionTimeout</code> - The amount of time (in milliseconds) to allow for a connection attempt to the Agent</li>
<li><code>ReconnectInterval</code> - The amount of time (in milliseconds) between adapter reconnection attempts</li>
<li><code>MultilineAssets</code> - Use multiline Assets</li>
<li><code>MultilineDevices</code> - Sets the default for Converting Units when adding Observations</li>
<li><code>FilterDuplicates</code> - Determines whether to filter out duplicate data</li>
<li><code>OutputTimestamps</code> - Determines whether to output Timestamps for each SHDR line</li>
</ul>
<h3>OutputTimestamps</h3>
<p>Timestamps may be output in the SHDR protocol in order to pass the timestamp from the Adapter instead of allowing the Agent to apply a timestamp.</p>
<p><b>OutputTimestamp</b> = true </p><div class="fragment"><div class="line">2023-01-27T03:47:53.4477372Z|L2estop|ARMED</div></div><!-- fragment --><p> <b>OutputTimestamp</b> = false </p><div class="fragment"><div class="line">L2estop|ARMED</div></div><!-- fragment --><h2>Sending Data</h2>
<p>### Add DataItems Individually </p><div class="fragment"><div class="line">{c#}</div><div class="line">// DataItemId and CDATA</div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;);</div><div class="line"></div><div class="line">// DataItemId and CDATA, and Timestamp</div><div class="line">adapter.AddDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;, DateTime.UtcNow);</div><div class="line"></div><div class="line">// DataItemId and CDATA as ShdrDataItem</div><div class="line">adapter.AddDataItem(new ShdrDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;));</div><div class="line"></div><div class="line">// DataItemId, CDATA, and Timestamp as ShdrDataItem</div><div class="line">adapter.AddDataItem(new ShdrDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;, DateTime.UtcNow));</div></div><!-- fragment --> <blockquote class="doxtable">
<p>If no timestamp is given then the timestamp will be set when the DataItem is sent to the Agent. To insure that all dataitems have the same timestamp, it can be set explicitly. </p>
</blockquote>
<p>### Add List of DataItems </p><div class="fragment"><div class="line">{c#}</div><div class="line">var ts = DateTime.UtcNow;</div><div class="line">var dataItems = new List&lt;ShdrDataItem&gt;();</div><div class="line"></div><div class="line">dataItems.Add(new ShdrDataItem(&quot;L2p1execution&quot;, &quot;READY&quot;, ts));</div><div class="line">dataItems.Add(new ShdrDataItem(&quot;L2p1Fovr&quot;, 100, ts));</div><div class="line">dataItems.Add(new ShdrDataItem(&quot;L2p1partcount&quot;, 15, ts));</div><div class="line">dataItems.Add(new ShdrDataItem(&quot;L2p1Fact&quot;, 250, ts));</div><div class="line"></div><div class="line">adapter.AddDataItems(dataItems);</div></div><!-- fragment --><p> #### Output </p><div class="fragment"><div class="line">2023-01-26T20:50:53.6161001Z|L2p1execution|READY|L2p1Fovr|100|L2p1partcount|15|L2p1Fact|250</div></div><!-- fragment --><p>### Store DataItems in Variables </p><div class="fragment"><div class="line">{c#}</div><div class="line">ShdrDataItem executionDataItem = new ShdrDataItem(&quot;L2p1execution&quot;);</div><div class="line">ShdrDataItem feedrateOverrideDataItem = new ShdrDataItem(&quot;L2p1Fovr&quot;);</div><div class="line">ShdrDataItem partCountDataItem = new ShdrDataItem(&quot;L2p1partcount&quot;);</div><div class="line">ShdrDataItem feedrateActualDataItem = new ShdrDataItem(&quot;L2p1Fact&quot;);</div><div class="line"></div><div class="line">executionDataItem.Value = &quot;READY&quot;;</div><div class="line">feedrateOverrideDataItem.Value = 100;</div><div class="line">partCountDataItem.Value = 15;</div><div class="line">feedrateActualDataItem.Value = 250;</div><div class="line"></div><div class="line">adapter.AddDataItem(executionDataItem);</div><div class="line">adapter.AddDataItem(feedrateOverrideDataItem);</div><div class="line">adapter.AddDataItem(partCountDataItem);</div><div class="line">adapter.AddDataItem(feedrateActualDataItem);</div></div><!-- fragment --><h3>Send DataItem Manually</h3>
<p>DataItems can be added to the Adapter and immediately send to the Agent using the "SendDataItem()" method </p><div class="fragment"><div class="line">{c#}</div><div class="line">adapter.SendDataItem(&quot;L2estop&quot;, &quot;ARMED&quot;);</div></div><!-- fragment --><h2>Conditions</h2>
<p>The ShdrCondition class is used to send MTConnect Condition data using the 5 primary values Level, NativeCode, NativeSeverity, Qualifier, and Message (referred to as Result in the MTConnect Standard). A Condition is made up of 1 or more FaultStates. Each FaultState is represented by the ShdrFaultState class.</p>
<p>#### Add a Fault Condition </p><div class="fragment"><div class="line">{c#}</div><div class="line">ShdrCondition condition = new ShdrCondition(&quot;L2p1system&quot;, ConditionLevel.FAULT);</div><div class="line">adapter.AddCondition(condition);</div></div><!-- fragment --><p>A Condition can also be added by using the built-in functions:</p>
<p>#### Set the Condition to Normal </p><div class="fragment"><div class="line">{c#}</div><div class="line">ShdrCondition condition = new ShdrCondition(&quot;L2p1system&quot;);</div><div class="line">condition.Normal();</div><div class="line"></div><div class="line">adapter.AddCondition(condition);</div></div><!-- fragment --><p>#### Set the Condition to Warning </p><div class="fragment"><div class="line">{c#}</div><div class="line">ShdrCondition condition = new ShdrCondition(&quot;L2p1system&quot;);</div><div class="line">condition.Warning(&quot;Not Found&quot;, &quot;404&quot;, &quot;100&quot;, ConditionQualifier.LOW);</div><div class="line"></div><div class="line">adapter.AddCondition(condition);</div></div><!-- fragment --><p>#### Set the Condition to Fault </p><div class="fragment"><div class="line">{c#}</div><div class="line">ShdrCondition condition = new ShdrCondition(&quot;L2p1system&quot;);</div><div class="line">condition.Fault(&quot;Internal Error&quot;, &quot;500&quot;, &quot;10254&quot;, ConditionQualifier.HIGH);</div><div class="line"></div><div class="line">adapter.AddCondition(condition);</div></div><!-- fragment --><p>#### Set multiple FaultStates </p><div class="fragment"><div class="line">{c#}</div><div class="line">ShdrCondition condition = new ShdrCondition(&quot;L2p1coolant&quot;);</div><div class="line">condition.AddWarning(&quot;Coolant Level Low&quot;, &quot;47321&quot;, qualifier: ConditionQualifier.LOW);</div><div class="line">condition.AddWarning(&quot;Coolant Temperature High&quot;, &quot;98712&quot;, qualifier: ConditionQualifier.HIGH);</div><div class="line"></div><div class="line">adapter.AddCondition(condition);</div></div><!-- fragment --><p>#### Set the Condition to Unavailable </p><div class="fragment"><div class="line">{c#}</div><div class="line">ShdrCondition condition = new ShdrCondition(&quot;L2p1system&quot;);</div><div class="line">condition.Unavailable();</div><div class="line"></div><div class="line">adapter.AddCondition(condition);</div></div><!-- fragment --><p>#### Add FaultStates Individually </p><div class="fragment"><div class="line">{c#}</div><div class="line">ShdrCondition condition = new ShdrCondition(&quot;L2p1system&quot;);</div><div class="line"></div><div class="line">ShdrFaultState faultState = new ShdrFaultState();</div><div class="line">faultState.NativeCode = &quot;404&quot;;</div><div class="line">faultState.NativeSeverity = &quot;100&quot;;</div><div class="line">faultState.Qualifier = &quot;LOW&quot;;</div><div class="line">faultState.Message = &quot;Testing from new adapter&quot;;</div><div class="line"></div><div class="line">condition.AddFaultState(faultState);</div><div class="line">adapter.AddCondition(condition);</div></div><!-- fragment --><h3>Send Condition Manually</h3>
<p>Conditions can be added to the Adapter and immediately send to the Agent using the "SendCondition()" method </p><div class="fragment"><div class="line">{c#}</div><div class="line">adapter.SendCondition(condition);</div></div><!-- fragment --><p>## TimeSeries </p><div class="fragment"><div class="line">{c#}</div><div class="line">List&lt;double&gt; samples = new List&lt;double&gt;();</div><div class="line">samples.Add(12);</div><div class="line">samples.Add(15);</div><div class="line">samples.Add(14);</div><div class="line">samples.Add(18);</div><div class="line">samples.Add(25);</div><div class="line">samples.Add(30);</div><div class="line"></div><div class="line">ShdrTimeSeries timeSeries = new ShdrTimeSeries(&quot;L2p1Sensor&quot;, samples, 100);</div><div class="line"></div><div class="line">adapter.AddTimeSeries(timeSeries);</div></div><!-- fragment --><p> ### Output </p><div class="fragment"><div class="line">2023-01-26T20:39:28.1540686Z|L2p1Sensor|6|100|12 15 14 18 25 30</div></div><!-- fragment --><h3>Send TimeSeries Manually</h3>
<p>TimeSeries can be added to the Adapter and immediately send to the Agent using the "SendTimeSeries()" method </p><div class="fragment"><div class="line">{c#}</div><div class="line">adapter.SendTimeSeries(timeSeries);</div></div><!-- fragment --><p>## DataSets </p><div class="fragment"><div class="line">{c#}</div><div class="line">List&lt;DataSetEntry&gt; dataSetEntries = new List&lt;DataSetEntry&gt;();</div><div class="line">dataSetEntries.Add(new DataSetEntry(&quot;V1&quot;, 5));</div><div class="line">dataSetEntries.Add(new DataSetEntry(&quot;V2&quot;, 205));</div><div class="line"></div><div class="line">ShdrDataSet dataSet = new ShdrDataSet(&quot;L2p1Variables&quot;, dataSetEntries);</div><div class="line"></div><div class="line">adapter.AddDataSet(dataSet);</div></div><!-- fragment --><p> ### Output </p><div class="fragment"><div class="line">2023-01-26T20:40:30.6718334Z|L2p1Variables|V1=5 V2=205</div></div><!-- fragment --><h3>Send DataSets Manually</h3>
<p>DataSets can be added to the Adapter and immediately send to the Agent using the "SendDataSets()" method </p><div class="fragment"><div class="line">{c#}</div><div class="line">adapter.SendDataSets(dataSet);</div></div><!-- fragment --><p>## Tables </p><div class="fragment"><div class="line">{c#}</div><div class="line">List&lt;TableEntry&gt; tableEntries = new List&lt;TableEntry&gt;();</div><div class="line"></div><div class="line">// Tool 1</div><div class="line">List&lt;TableCell&gt; t1Cells = new List&lt;TableCell&gt;();</div><div class="line">t1Cells.Add(new TableCell(&quot;LENGTH&quot;, 7.123));</div><div class="line">t1Cells.Add(new TableCell(&quot;DIAMETER&quot;, 0.494));</div><div class="line">t1Cells.Add(new TableCell(&quot;REMAINING_LIFE&quot;, 35));</div><div class="line">tableEntries.Add(new TableEntry(&quot;T1&quot;, t1Cells));</div><div class="line"></div><div class="line">// Tool 2</div><div class="line">List&lt;TableCell&gt; t2Cells = new List&lt;TableCell&gt;();</div><div class="line">t2Cells.Add(new TableCell(&quot;LENGTH&quot;, 10.456));</div><div class="line">t2Cells.Add(new TableCell(&quot;DIAMETER&quot;, 0.125));</div><div class="line">t2Cells.Add(new TableCell(&quot;REMAINING_LIFE&quot;, 100));</div><div class="line">tableEntries.Add(new TableEntry(&quot;T2&quot;, t2Cells));</div><div class="line"></div><div class="line">// Tool 3</div><div class="line">List&lt;TableCell&gt; t3Cells = new List&lt;TableCell&gt;();</div><div class="line">t3Cells.Add(new TableCell(&quot;LENGTH&quot;, 6.251));</div><div class="line">t3Cells.Add(new TableCell(&quot;DIAMETER&quot;, 1.249));</div><div class="line">t3Cells.Add(new TableCell(&quot;REMAINING_LIFE&quot;, 93));</div><div class="line">tableEntries.Add(new TableEntry(&quot;T3&quot;, t3Cells));</div><div class="line"></div><div class="line">ShdrTable table = new ShdrTable(&quot;L2p1ToolTable&quot;, tableEntries);</div><div class="line"></div><div class="line">adapter.AddTable(table);</div></div><!-- fragment --><p> ### Output </p><div class="fragment"><div class="line">2023-01-26T20:40:55.8702675Z|L2p1ToolTable|T1={LENGTH=7.123 DIAMETER=0.494 TOOL_LIFE=0.35} T2={LENGTH=10.456 DIAMETER=0.125 TOOL_LIFE=1} T3={LENGTH=6.251 DIAMETER=1.249 TOOL_LIFE=0.93}</div></div><!-- fragment --><h3>Send Tables Manually</h3>
<p>Tables can be added to the Adapter and immediately send to the Agent using the "SendTables()" method </p><div class="fragment"><div class="line">{c#}</div><div class="line">adapter.SendTables(table);</div></div><!-- fragment --><h2>Assets</h2>
<p>MTConnect Assets are sent by first defining the Asset using the appropriate class (CuttingToolAsset, FileAsset, etc.) then using the "AddAsset()".</p>
<p>### CuttingTool Asset </p><div class="fragment"><div class="line">{c#}</div><div class="line">using MTConnect.Assets.CuttingTools;</div><div class="line">using MTConnect.Assets.CuttingTools.Measurements;</div><div class="line"></div><div class="line">var tool = new CuttingToolAsset();</div><div class="line">tool.AssetId = &quot;5.12&quot;;</div><div class="line">tool.ToolId = &quot;12&quot;;</div><div class="line">tool.CuttingToolLifeCycle = new CuttingToolLifeCycle</div><div class="line">{</div><div class="line">    Location = new Location { Type = LocationType.SPINDLE },</div><div class="line">    ProgramToolNumber = &quot;12&quot;,</div><div class="line">    ProgramToolGroup = &quot;5&quot;</div><div class="line">};</div><div class="line">tool.CuttingToolLifeCycle.Measurements.Add(new FunctionalLengthMeasurement(7.6543));</div><div class="line">tool.CuttingToolLifeCycle.Measurements.Add(new CuttingDiameterMaxMeasurement(0.375));</div><div class="line">tool.CuttingToolLifeCycle.CuttingItems.Add(new CuttingItem</div><div class="line">{</div><div class="line">    ItemId = &quot;12.1&quot;,</div><div class="line">    Locus = CuttingItemLocas.FLUTE.ToString()</div><div class="line">});</div><div class="line">tool.CuttingToolLifeCycle.CutterStatus.Add(CutterStatus.AVAILABLE);</div><div class="line">tool.CuttingToolLifeCycle.CutterStatus.Add(CutterStatus.NEW);</div><div class="line">tool.CuttingToolLifeCycle.CutterStatus.Add(CutterStatus.MEASURED);</div><div class="line">tool.DateTime = DateTime.Now;</div><div class="line"></div><div class="line">adapter.AddAsset(tool);</div></div><!-- fragment --><p> #### Output (with MultilineAssets = true) </p><div class="fragment"><div class="line">2023-01-26T17:56:59.9694353Z|@ASSET@|5.12|CuttingTool|--multiline--W5XZBJ2QZV</div><div class="line">&lt;CuttingTool assetId=&quot;5.12&quot; timestamp=&quot;2023-01-26T12:56:59.4778578-05:00&quot; toolId=&quot;12&quot;&gt;</div><div class="line">  &lt;CuttingToolLifeCycle&gt;</div><div class="line">    &lt;CutterStatus&gt;</div><div class="line">      &lt;Status&gt;AVAILABLE&lt;/Status&gt;</div><div class="line">      &lt;Status&gt;NEW&lt;/Status&gt;</div><div class="line">      &lt;Status&gt;MEASURED&lt;/Status&gt;</div><div class="line">    &lt;/CutterStatus&gt;</div><div class="line">    &lt;Location type=&quot;SPINDLE&quot;&gt;0&lt;/Location&gt;</div><div class="line">    &lt;ProgramToolGroup&gt;5&lt;/ProgramToolGroup&gt;</div><div class="line">    &lt;ProgramToolNumber&gt;12&lt;/ProgramToolNumber&gt;</div><div class="line">    &lt;Measurements&gt;</div><div class="line">      &lt;FunctionalLength units=&quot;MILLIMETER&quot; code=&quot;LF&quot;&gt;7.6543&lt;/FunctionalLength&gt;</div><div class="line">      &lt;CuttingDiameterMax units=&quot;MILLIMETER&quot; code=&quot;DC&quot;&gt;0.375&lt;/CuttingDiameterMax&gt;</div><div class="line">    &lt;/Measurements&gt;</div><div class="line">    &lt;CuttingItems count=&quot;1&quot;&gt;</div><div class="line">      &lt;CuttingItem itemId=&quot;12.1&quot;&gt;</div><div class="line">        &lt;Locus&gt;FLUTE&lt;/Locus&gt;</div><div class="line">      &lt;/CuttingItem&gt;</div><div class="line">    &lt;/CuttingItems&gt;</div><div class="line">  &lt;/CuttingToolLifeCycle&gt;</div><div class="line">&lt;/CuttingTool&gt;</div><div class="line">--multiline--W5XZBJ2QZV</div></div><!-- fragment --><p>### File Asset </p><div class="fragment"><div class="line">{c#}</div><div class="line">using MTConnect.Assets.Files;</div><div class="line"></div><div class="line">var file = new FileAsset();</div><div class="line">file.DateTime = DateTime.UtcNow;</div><div class="line">file.AssetId = &quot;file.test&quot;;</div><div class="line">file.Size = 12346;</div><div class="line">file.VersionId = &quot;test-v1&quot;;</div><div class="line">file.State = FileState.PRODUCTION;</div><div class="line">file.Name = &quot;file-123.txt&quot;;</div><div class="line">file.MediaType = &quot;text/plain&quot;;</div><div class="line">file.ApplicationCategory = ApplicationCategory.DEVICE;</div><div class="line">file.ApplicationType = ApplicationType.DATA;</div><div class="line">file.FileLocation = new FileLocation(@&quot;C:\temp\file-123.txt&quot;);</div><div class="line">file.CreationTime = DateTime.Now;</div><div class="line"></div><div class="line">adapter.AddAsset(file);</div></div><!-- fragment --><p> #### Output (with MultilineAssets = true) </p><div class="fragment"><div class="line">2023-01-26T18:01:50.3085245Z|@ASSET@|file.test|File|--multiline--6UH71Y7IYW</div><div class="line">&lt;File assetId=&quot;file.test&quot; timestamp=&quot;2023-01-26T18:01:49.9929867Z&quot; name=&quot;file-123.txt&quot; mediaType=&quot;text/plain&quot; applicationCategory=&quot;DEVICE&quot; applicationType=&quot;DATA&quot; size=&quot;12346&quot; versionId=&quot;test-v1&quot; state=&quot;PRODUCTION&quot;&gt;</div><div class="line">  &lt;FileLocation href=&quot;C:\temp\file-123.txt&quot; /&gt;</div><div class="line">  &lt;CreationTime&gt;2023-01-26T13:01:49.9939538-05:00&lt;/CreationTime&gt;</div><div class="line">&lt;/File&gt;</div><div class="line">--multiline--6UH71Y7IYW</div></div><!-- fragment --><p>### Add Multiple Assets </p><div class="fragment"><div class="line">{c#}</div><div class="line">using MTConnect.Assets.CuttingTools;</div><div class="line">using MTConnect.Assets.CuttingTools.Measurements;</div><div class="line">using MTConnect.Assets.Files;</div><div class="line"></div><div class="line">var assets = new List&lt;IAsset&gt;();</div><div class="line"></div><div class="line"></div><div class="line">// Add the Cutting Tool Asset to the &quot;assets&quot; list variable</div><div class="line">var tool = new CuttingToolAsset();</div><div class="line">tool.AssetId = &quot;5.12&quot;;</div><div class="line">tool.ToolId = &quot;12&quot;;</div><div class="line">tool.CuttingToolLifeCycle = new CuttingToolLifeCycle</div><div class="line">{</div><div class="line">    Location = new Location { Type = LocationType.SPINDLE },</div><div class="line">    ProgramToolNumber = &quot;12&quot;,</div><div class="line">    ProgramToolGroup = &quot;5&quot;</div><div class="line">};</div><div class="line">tool.CuttingToolLifeCycle.Measurements.Add(new FunctionalLengthMeasurement(7.6543));</div><div class="line">tool.CuttingToolLifeCycle.Measurements.Add(new CuttingDiameterMaxMeasurement(0.375));</div><div class="line">tool.CuttingToolLifeCycle.CuttingItems.Add(new CuttingItem</div><div class="line">{</div><div class="line">    ItemId = &quot;12.1&quot;,</div><div class="line">    Locus = CuttingItemLocas.FLUTE.ToString()</div><div class="line">});</div><div class="line">tool.CuttingToolLifeCycle.CutterStatus.Add(CutterStatus.AVAILABLE);</div><div class="line">tool.CuttingToolLifeCycle.CutterStatus.Add(CutterStatus.NEW);</div><div class="line">tool.CuttingToolLifeCycle.CutterStatus.Add(CutterStatus.MEASURED);</div><div class="line">tool.DateTime = DateTime.Now;</div><div class="line"></div><div class="line">assets.Add(tool);</div><div class="line"></div><div class="line"></div><div class="line">// Add the File Asset to the &quot;assets&quot; list variable</div><div class="line">var file = new FileAsset();</div><div class="line">file.DateTime = DateTime.UtcNow;</div><div class="line">file.AssetId = &quot;file.test&quot;;</div><div class="line">file.Size = 12346;</div><div class="line">file.VersionId = &quot;test-v1&quot;;</div><div class="line">file.State = FileState.PRODUCTION;</div><div class="line">file.Name = &quot;file-123.txt&quot;;</div><div class="line">file.MediaType = &quot;text/plain&quot;;</div><div class="line">file.ApplicationCategory = ApplicationCategory.DEVICE;</div><div class="line">file.ApplicationType = ApplicationType.DATA;</div><div class="line">file.FileLocation = new FileLocation(@&quot;C:\temp\file-123.txt&quot;);</div><div class="line">file.CreationTime = DateTime.Now;</div><div class="line"></div><div class="line">assets.Add(file);</div><div class="line"></div><div class="line">adapter.AddAssets(assets);</div></div><!-- fragment --><h3>Send Asset Manually</h3>
<p>Assets can be added to the Adapter and immediately send to the Agent using the "SendAsset()" method </p><div class="fragment"><div class="line">{c#}</div><div class="line">using MTConnect.Assets.Files;</div><div class="line"></div><div class="line">var file = new FileAsset();</div><div class="line">// ..</div><div class="line">// ..</div><div class="line">// ..</div><div class="line"></div><div class="line">adapter.SendAsset(file);</div></div><!-- fragment --><p>### Remove Individual Asset by AssetId </p><div class="fragment"><div class="line">{c#}</div><div class="line">adapter.RemoveAsset(&quot;file.test&quot;);</div></div><!-- fragment --><p> #### Output </p><div class="fragment"><div class="line">2023-01-26T18:21:57.8208518Z|@REMOVE_ASSET@|file.test</div></div><!-- fragment --><p>### Remove All Assets of a specified Type </p><div class="fragment"><div class="line">{c#}</div><div class="line">adapter.RemoveAllAssets(&quot;File&quot;);</div></div><!-- fragment --><p> #### Output </p><div class="fragment"><div class="line">2023-01-26T18:31:23.6664032Z|@REMOVE_ALL_ASSETS@|File</div></div><!-- fragment --><h2>SHDR Conversion</h2>
<p>Conversion to and from an SHDR message is done through methods in the ShdrDataItem, ShdrCondition, ShdrTimeSeries, ShdrDataSet, and ShdrTable classes. Each class overrides the base "ToString()" method and also contains a "FromString()" method. The "ToString()" method creates an SHDR compatible string from the object and the "FromString()" creates an object from an SHDR string.</p>
<p>### ShdrDataItem.ToString() </p><div class="fragment"><div class="line">{c#}</div><div class="line">ShdrDataItem availableDataItem = new ShdrDataItem(&quot;L2avail&quot;, Availability.AVAILABLE, DateTime.UtcNow);</div><div class="line">Console.WriteLine(availableDataItem);</div></div><!-- fragment --> <blockquote class="doxtable">
<p>2022-02-01T13:53:03.6940000Z|L2avail|AVAILABLE </p>
</blockquote>
<p>### ShdrCondition.ToString() </p><div class="fragment"><div class="line">{c#}</div><div class="line">ShdrCondition condition = new ShdrCondition(&quot;L2p1system&quot;, ConditionLevel.FAULT, DateTime.UtcNow);</div><div class="line">condition.NativeCode = &quot;404&quot;;</div><div class="line">condition.NativeSeverity = &quot;100&quot;;</div><div class="line">condition.Qualifier = &quot;LOW&quot;;</div><div class="line">condition.Message = &quot;Testing from new adapter&quot;;</div><div class="line">Console.WriteLine(condition);</div></div><!-- fragment --> <blockquote class="doxtable">
<p>2022-02-01T13:55:11.8460000Z|L2p1system|FAULT|404|100|LOW|Testing from new adapter </p>
</blockquote>
<p>### ShdrTimeSeries.ToString() </p><div class="fragment"><div class="line">{c#}</div><div class="line">List&lt;double&gt; samples = new List&lt;double&gt;();</div><div class="line">samples.Add(12);</div><div class="line">samples.Add(15);</div><div class="line">samples.Add(14);</div><div class="line">samples.Add(18);</div><div class="line">samples.Add(25);</div><div class="line">samples.Add(30);</div><div class="line"></div><div class="line">ShdrTimeSeries timeSeries = new ShdrTimeSeries(&quot;L2p1Sensor&quot;, samples, 100, DateTime.UtcNow);</div><div class="line">Console.WriteLine(timeSeries);</div></div><!-- fragment --> <blockquote class="doxtable">
<p>2022-02-01T13:56:58.7700000Z|L2p1Sensor|6|100|12 15 14 18 25 30 </p>
</blockquote>
<p>### ShdrDataSet.ToString() </p><div class="fragment"><div class="line">{c#}</div><div class="line">List&lt;DataSetEntry&gt; dataSetEntries = new List&lt;DataSetEntry&gt;();</div><div class="line">dataSetEntries.Add(new DataSetEntry(&quot;V1&quot;, 5));</div><div class="line">dataSetEntries.Add(new DataSetEntry(&quot;V2&quot;, 205));</div><div class="line"></div><div class="line">ShdrDataSet dataSet = new ShdrDataSet(&quot;L2p1Variables&quot;, dataSetEntries, DateTime.UtcNow);</div><div class="line">Console.WriteLine(dataSet);</div></div><!-- fragment --> <blockquote class="doxtable">
<p>2022-02-01T13:58:31.8150000Z|L2p1Variables|V1=5 V2=205 </p>
</blockquote>
<p>### ShdrTable.ToString() </p><div class="fragment"><div class="line">{c#}</div><div class="line">List&lt;TableEntry&gt; tableEntries = new List&lt;TableEntry&gt;();</div><div class="line"></div><div class="line">// Tool 1</div><div class="line">List&lt;TableCell&gt; t1Cells = new List&lt;TableCell&gt;();</div><div class="line">t1Cells.Add(new TableCell(&quot;LENGTH&quot;, 7.123));</div><div class="line">t1Cells.Add(new TableCell(&quot;DIAMETER&quot;, 0.494));</div><div class="line">t1Cells.Add(new TableCell(&quot;TOOL_LIFE&quot;, 0.35));</div><div class="line">tableEntries.Add(new TableEntry(&quot;T1&quot;, t1Cells));</div><div class="line"></div><div class="line">// Tool 2</div><div class="line">List&lt;TableCell&gt; t2Cells = new List&lt;TableCell&gt;();</div><div class="line">t2Cells.Add(new TableCell(&quot;LENGTH&quot;, 10.456));</div><div class="line">t2Cells.Add(new TableCell(&quot;DIAMETER&quot;, 0.125));</div><div class="line">t2Cells.Add(new TableCell(&quot;TOOL_LIFE&quot;, 1));</div><div class="line">tableEntries.Add(new TableEntry(&quot;T2&quot;, t2Cells));</div><div class="line"></div><div class="line">// Tool 3</div><div class="line">List&lt;TableCell&gt; t3Cells = new List&lt;TableCell&gt;();</div><div class="line">t3Cells.Add(new TableCell(&quot;LENGTH&quot;, 6.251));</div><div class="line">t3Cells.Add(new TableCell(&quot;DIAMETER&quot;, 1.249));</div><div class="line">t3Cells.Add(new TableCell(&quot;TOOL_LIFE&quot;, 0.93));</div><div class="line">tableEntries.Add(new TableEntry(&quot;T3&quot;, t3Cells));</div><div class="line"></div><div class="line">ShdrTable table = new ShdrTable(&quot;L2p1ToolTable&quot;, tableEntries, DateTime.UtcNow);</div><div class="line">Console.WriteLine(table);</div></div><!-- fragment --> <blockquote class="doxtable">
<p>2022-02-01T13:59:47.5980000Z|L2p1ToolTable|T1={LENGTH=7.123 DIAMETER=0.494 TOOL_LIFE=0.35} T2={LENGTH=10.456 DIAMETER=0.125 TOOL_LIFE=1} T3={LENGTH=6.251 DIAMETER=1.249 TOOL_LIFE=0.93}</p>
</blockquote>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré par &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
